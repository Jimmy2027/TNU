function [y,h,x] = euler_integrate_dcm(U,P,pHRF,x0,h0)
y = zeros(800,1);
h = zeros(800,4);
x = zeros(800,2);
h(1,:) = [0,1,1,1];
y(1,:) = compute_bold_signal(h(1,:), pHRF);
A = [-0.5, 0; 1, -0.5];
B = [0,0;-0.5, 0];
C = [1, 0;0,0];
P = struct{'A',A, 'B',B, 'C',C}
for i= 2:800
    x(i,:) = single_step_neural(x(i-1,:),U(i), P)
    
end
    